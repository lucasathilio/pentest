<?php
$host = "mysql";
$db_name = "payroll";
$db_username = "root";
$db_password = "pujkFGC471-2j";

// Conectando ao banco de dados
$conn = new mysqli($host, $db_username, $db_password, $db_name);

// Verificando a conexão
if ($conn->connect_error) {
    die("Connection failed: " . $conn->connect_error);
}

// Verificando se o parâmetro 'query' foi passado
if (isset($_GET['query'])) {
    $query = $_GET['query'];
    echo "<p>Executing query: " . htmlspecialchars($query) . "</p>";

    // Executando a consulta
    if ($result = $conn->query($query)) {
        // Verificando se a consulta retornou resultados
        if ($result->num_rows > 0) {
            echo "<table border='1' cellspacing='0' cellpadding='10'><tr>";
            
            // Exibindo os nomes das colunas
            while ($columnInfo = $result->fetch_field()) {
                echo "<th>" . htmlspecialchars($columnInfo->name) . "</th>";
            }
            echo "</tr>";

            // Exibindo os dados das linhas
            while ($row = $result->fetch_assoc()) {
                echo "<tr>";
                foreach ($row as $data) {
                    echo "<td>" . htmlspecialchars($data) . "</td>";
                }
                echo "</tr>";
            }
            echo "</table>";
        } else {
            echo "No results found.";
        }
    } else {
        echo "Error executing query: " . $conn->error;
    }
} else {
    echo "No query provided.";
}

// Fechando a conexão
$conn->close();
?>
